import{i as x,o as c,c as u,a as t,t as h,k as b,K as L,f as m,F as $,r as C,s as w,v as S,L as k,l as A,u as U,j as V,b as f,x as B}from"./entry.slxBjbjw.js";import{u as D}from"./useCars.swDCQaES.js";import{u as F}from"./useSupabaseClient.DrhiYwAb.js";const T={class:"flex flex-col w-[48%] mt-2"},R={class:"text-cyan-500 mb-1 text-sm"},j=["value"],E={__name:"AdSelect",props:{title:String,name:String,options:Array},emits:["changeInput"],setup(s,{emit:d}){const l=s,i=d,e=x(""),n=()=>{i("changeInput",e.value,l.name)};return(r,a)=>(c(),u("div",T,[t("div",R,h(s.title),1),b(t("select",{name:"",id:"",class:"p-2 border w-100 rounded",onChange:n,"onUpdate:modelValue":a[0]||(a[0]=o=>w(e)?e.value=o:null)},[(c(!0),u($,null,C(s.options,o=>(c(),u("option",{key:o.id,value:o},h(o),9,j))),128))],544),[[L,m(e)]])]))}},K=E,P={class:"flex flex-col w-[48%] mt-2"},Y={class:"text-cyan-500 mb-1 text-sm"},q=["placeholder","name"],z={__name:"AdInput",props:{title:String,name:String,placeholder:String},emits:["changeInput"],setup(s,{emit:d}){const l=s,i=d,e=x(""),n=()=>{i("changeInput",e.value,l.name)};return(r,a)=>(c(),u("div",P,[t("div",Y,h(s.title),1),b(t("input",{type:"text",class:"p-2 border w-100 rounded",placeholder:s.placeholder,"onUpdate:modelValue":a[0]||(a[0]=o=>w(e)?e.value=o:null),name:s.name,onInput:n},null,40,q),[[S,m(e)]])]))}},G=z,H={class:"flex flex-col w-[100%] mt-2"},J={class:"text-cyan-500 mb-1 text-sm"},O=["placeholder","name"],Q={__name:"AdTextarea",props:{title:String,name:String,placeholder:String},emits:["changeInput"],setup(s,{emit:d}){const l=s,i=d,e=x(""),n=()=>{i("changeInput",e.value,l.name)};return(r,a)=>(c(),u("div",H,[t("div",J,h(s.title),1),b(t("textarea",{type:"text",class:"p-2 border w-100 rounded",placeholder:s.placeholder,"onUpdate:modelValue":a[0]||(a[0]=o=>w(e)?e.value=o:null),name:s.name,onInput:n},null,40,O),[[S,m(e)]])]))}},W=Q,X={class:"col-md-5 offset-md-1 mt-2 w-[100%]"},Z=t("div",{class:"text-cyan-500 mb-1 text-sm"},"Image*",-1),ee={class:"mt-2"},te={class:"form-group"},ae={class:"relative"},se=t("span",{class:"cursor-pointer"},"Browser File",-1),ne={key:0,class:"border p-2 mt-3 w-56"},oe=["src"],le={__name:"AdImage",emits:["changeInput"],setup(s,{emit:d}){const l=k("carImage",()=>({preview:null,image:null})),i=d,e=n=>{const r=n.target;if(r.files){const a=new FileReader;a.onload=o=>{l.value.preview=o.target.result},l.value.image=r.files[0],a.readAsDataURL(r.files[0]),i("changeInput",r.files[0],"image")}};return(n,r)=>(c(),u("div",X,[Z,t("form",ee,[t("div",te,[t("div",ae,[t("input",{type:"file",accept:"image/*",class:"opacity-0 absolute cursor-pointer",onChange:e},null,32),se]),m(l).preview?(c(),u("div",ne,[t("img",{src:m(l).preview,class:"img-fluid"},null,8,oe)])):A("",!0)])])]))}},ie=le,re=t("div",{class:"mt-24"},[t("h1",{class:"text-6xl"},"Create a New Listing")],-1),ce={class:"shadow rounded p-3 mt-5 flex flex-wrap justify-between"},ue=["disabled"],de={key:0,class:"text-red-400"},he={__name:"create",setup(s){const{makes:d}=D(),l=U(),i=F(),e=k("adInfo",()=>({make:"",model:"",year:"",miles:"",price:"",city:"",seats:"",features:"",description:"",image:null})),n=(p,_)=>{e.value[_]=p},r=[{id:1,title:"Model *",name:"model",placeholder:"Civic"},{id:2,title:"Year *",name:"year",placeholder:"2019"},{id:3,title:"Price *",name:"price",placeholder:"39000"},{id:4,title:"Miles *",name:"miles",placeholder:"10000"},{id:5,title:"City *",name:"city",placeholder:"Austin"},{id:6,title:"Number of Seats *",name:"seats",placeholder:"5"},{id:7,title:"Features *",name:"features",placeholder:"Leather Interior, No Accidents"}],a=x(""),o=async()=>{const p=Math.floor(Math.random()*1e14),{data:_,error:y}=await i.storage.from("images").upload("public/"+p,e.value.image);if(y)return a.value="Cannot upload image.";const I={...e.value,city:e.value.city.toLowerCase(),features:e.value.features.split("/ "),seats:parseInt(e.value.seats),price:parseInt(e.value.price),miles:parseInt(e.value.miles),year:parseInt(e.value.year),name:`${e.value.make} ${e.value.model}`,listerId:l.value.id,image:_.path};try{const g=await $fetch("/api/car/listings",{method:"post",body:I});e.value={make:"",model:"",year:"",miles:"",price:"",city:"",seats:"",features:"",description:"",image:null},B("/profile/listings")}catch(g){a.value=g.statusMessage,await i.storage.from("images").remove(_.path)}},M=V(()=>{for(let p in e.value)if(!e.value[p])return!0;return!1});return(p,_)=>{const y=K,I=G,g=W,N=ie;return c(),u("div",null,[re,t("div",ce,[f(y,{title:"Make *",options:m(d),name:"make",onChangeInput:n},null,8,["options"]),(c(),u($,null,C(r,v=>f(I,{key:v.id,title:v.title,name:v.name,placeholder:v.placeholder,onChangeInput:n},null,8,["title","name","placeholder"])),64)),f(g,{title:"Description *",name:"description",placeholder:"",onChangeInput:n}),f(N,{onChangeInput:n}),t("div",null,[t("button",{onClick:o,disabled:m(M),class:"btn btn-primary mt-3"}," Submit ",8,ue)]),m(a)?(c(),u("div",de,h(m(a)),1)):A("",!0)])])}}};export{he as default};
